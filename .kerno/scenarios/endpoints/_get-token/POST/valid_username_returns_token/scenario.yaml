id: valid_username_returns_token
description: Request with valid username returns 200 OK with JWT token
subject:
  type: "Endpoint"
  method: POST
  path: /v1/get-token
steps:
- id: generate_test_data
  description: Generate random username for test
  action:
    type: "Values"
    outputs:
      username:
        type: "RandomUuid"
- id: call_get_token
  description: Call POST /v1/get-token with valid username
  action:
    type: "CallHttp"
    request: |-
      POST /v1/get-token HTTP/1.1
      Content-Type: application/x-www-form-urlencoded

      username={{ generate_test_data.username }}
- id: assert_token_response
  description: Assert 200 OK response with access_token and token_type bearer
  action:
    type: "HttpAssert"
    actual: '{{ call_get_token }}'
    expected: |-
      HTTP/1.1 200 OK
      Content-Type: application/json

      {"token_type":"bearer"}
    body_match: json_lenient
